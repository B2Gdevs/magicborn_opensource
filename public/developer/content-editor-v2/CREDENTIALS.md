# Content Editor v2 - Credentials and Access

## ⚠️ SECURITY WARNING

**These credentials are for DEVELOPMENT ONLY.**
**CHANGE ALL PASSWORDS IN PRODUCTION!**

---

## Payload CMS Admin Credentials

### Superuser Account

**Email:** `admin@magicborn.com`  
**Password:** `admin123`

**⚠️ CHANGE THIS PASSWORD IMMEDIATELY IN PRODUCTION!**

### Access Points

- **Payload Admin UI:** `http://localhost:3000/admin`
- **Content Editor:** `http://localhost:3000/content-editor/1`

### Default Project

- **Project ID:** `1`
- **Project Name:** "Default Project"
- **Magicborn Mode:** Enabled
- **Owner:** Superuser (admin@magicborn.com)

---

## How to Change Superuser Password

### Via Payload Admin UI

1. Navigate to `http://localhost:3000/admin`
2. Login with current credentials
3. Go to Users collection
4. Edit the superuser account
5. Update password field
6. Save

### Via Payload API

```bash
curl -X PATCH http://localhost:3000/api/payload/users/[user-id] \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer [token]" \
  -d '{"password": "new-secure-password"}'
```

### Via Script

Create a script to update password programmatically:

```typescript
// scripts/update-superuser-password.ts
import { getPayload } from 'payload'
import config from '../payload.config'

async function updatePassword() {
  const payload = await getPayload({ config })
  
  const users = await payload.find({
    collection: 'users',
    where: {
      email: { equals: 'admin@magicborn.com' }
    }
  })
  
  if (users.docs.length > 0) {
    await payload.update({
      collection: 'users',
      id: users.docs[0].id,
      data: {
        password: 'new-secure-password'
      }
    })
    console.log('Password updated successfully')
  }
}

updatePassword()
```

---

## Creating Additional Users

### Via Payload Admin UI

1. Navigate to `http://localhost:3000/admin`
2. Go to Users collection
3. Click "Create New"
4. Fill in:
   - Email
   - Password
   - Name (optional)
   - isSuperuser (uncheck for regular users)
5. Save

### Via Payload API

```bash
curl -X POST http://localhost:3000/api/payload/users \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer [token]" \
  -d '{
    "email": "user@example.com",
    "password": "secure-password",
    "name": "User Name",
    "isSuperuser": false
  }'
```

---

## Project Access

### Adding Users to Projects

Users need to be added to projects via `projectMembers` collection:

1. Navigate to `http://localhost:3000/admin`
2. Go to Project Members collection
3. Click "Create New"
4. Fill in:
   - Project: Select project
   - User: Select user
   - Role: owner | admin | editor | viewer
5. Save

### Roles

- **owner** - Full control, can delete project
- **admin** - Can manage members, edit all content
- **editor** - Can create/edit content
- **viewer** - Read-only access

---

## Docker Services Credentials

### PostgreSQL (n8n)

**Connection:** Internal Docker network only  
**Host:** `postgres`  
**Database:** Set via `POSTGRES_DB` env var  
**User:** Set via `POSTGRES_USER` env var  
**Password:** Set via `POSTGRES_PASSWORD` env var

**Location:** `infra/ai-stack/.env`

### n8n

**URL:** `http://localhost:5678`  
**Auth:** Disabled in development (`N8N_BASIC_AUTH_ACTIVE=false`)

**Production Setup:**
- Set `N8N_BASIC_AUTH_ACTIVE=true`
- Set `N8N_BASIC_AUTH_USER` and `N8N_BASIC_AUTH_PASSWORD`

### OpenWebUI

**URL:** `http://localhost:8080`  
**Auth:** Disabled in development (`WEBUI_AUTH=False`)

**Production Setup:**
- Set `WEBUI_AUTH=True`
- Create admin account via UI

---

## Environment Variables

### Payload

**Location:** `.env.local` (generated by init script)

```bash
PAYLOAD_SECRET=<auto-generated>
PAYLOAD_PUBLIC_SERVER_URL=http://localhost:3000
```

### Docker Services

**Location:** `infra/ai-stack/.env`

```bash
POSTGRES_USER=<your-postgres-user>
POSTGRES_PASSWORD=<your-postgres-password>
POSTGRES_DB=<your-postgres-db>
N8N_ENCRYPTION_KEY=<your-n8n-key>
N8N_USER_MANAGEMENT_JWT_SECRET=<your-n8n-jwt-secret>
```

---

## Security Best Practices

### Development

- ✅ Use default credentials for local development
- ✅ Keep credentials in `.env.local` (gitignored)
- ✅ Don't commit credentials to git

### Production

- ❌ **NEVER** use default passwords
- ✅ Use strong, unique passwords
- ✅ Rotate secrets regularly
- ✅ Use environment variables (not hardcoded)
- ✅ Enable authentication on all services
- ✅ Use HTTPS
- ✅ Implement rate limiting
- ✅ Set up proper CORS policies
- ✅ Use PostgreSQL (not SQLite) for Payload
- ✅ Enable database backups

---

## Access Control Summary

### Superuser

- Can access all projects
- Can create/delete projects
- Can manage all users
- Bypasses all access restrictions

### Regular Users

- Can only access projects they're members of
- Access level determined by role:
  - **owner/admin:** Full project control
  - **editor:** Create/edit content
  - **viewer:** Read-only

### Project-Level Access

- Every content document belongs to a project
- Access automatically filtered by project membership
- No manual filtering needed in queries

---

## Troubleshooting Access Issues

### Can't Login to Payload Admin

1. Check if superuser exists:
   ```bash
   npm run payload:init
   ```

2. Verify credentials in database:
   - Check `data/payload.db` (if you have DB tools)
   - Or use Payload Local API

### Can't Access Project Content

1. Check project membership:
   - User must be in `projectMembers` collection
   - Verify role has appropriate permissions

2. Check project ID:
   - Ensure you're using correct project ID in URL
   - Verify project exists

### Access Denied Errors

1. Check access control rules in collection configs
2. Verify user's project memberships
3. Check if user is superuser (superusers bypass restrictions)

---

## Initialization

### First-Time Setup

Run initialization script to create superuser and default project:

```bash
npm run payload:init
```

This creates:
- Superuser: `admin@magicborn.com` / `admin123`
- Default project with ID `1`
- Project membership linking superuser to project

### Re-initialization

The script checks if superuser exists and skips creation if found. To force re-initialization:

1. Delete `data/payload.db`
2. Run `npm run payload:init` again

---

## Related Documentation

- [ARCHITECTURE.md](./ARCHITECTURE.md) - System architecture
- [SETUP_LOG.md](./SETUP_LOG.md) - Setup process
- [ISSUES_AND_FIXES.md](./ISSUES_AND_FIXES.md) - Known issues




